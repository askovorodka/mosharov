{literal}
<script type="text/javascript" src="{/literal}{$base_url}{literal}/javascript/jquery-1.3.2.js"></script>
<script type="text/javascript" src="{/literal}{$base_url}/{literal}javascript/tinymce/jscripts/tiny_mce/jquery.tinymce.js"></script>
<script language="javascript" type="text/javascript" src="{/literal}{$base_url}/{literal}javascript/tinymce/jscripts/tiny_mce/plugins/imagemanager/js/mcimagemanager.js"></script>
<script type="text/javascript">
	$().ready(function() {
		$("textarea[name='code']").tinymce({
			// Location of TinyMCE script
			script_url : '{/literal}{$base_url}/{literal}javascript/tinymce/jscripts/tiny_mce/tiny_mce.js',
			relative_urls:false,
			convert_urls:false,
			remove_script_host:false,
			// General options
			theme : "advanced",
			plugins : "safari,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

			// Theme options
			theme_advanced_buttons1 : "save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
			theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,anchor,image,insertimage,cleanup,help,code,|,insertdate,inserttime,preview,|,forecolor,backcolor",
			theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
			theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|,cite,abbr,acronym,del,ins,attribs,|,visualchars,nonbreaking,template,pagebreak",
			theme_advanced_toolbar_location : "top",
			theme_advanced_toolbar_align : "left",
			theme_advanced_statusbar_location : "bottom",
			theme_advanced_resizing : true,
			file_browser_callback : "mcImageManager.filebrowserCallBack",

			// Example content CSS (should be your site CSS)
			content_css : "/templates/style.css",

			// Drop lists for link/image/media/template dialogs
			template_external_list_url : "lists/template_list.js",
			external_link_list_url : "lists/link_list.js",
			external_image_list_url : "lists/image_list.js",
			media_external_list_url : "lists/media_list.js",

			// Replace values for the template plugin
			template_replace_values : {
				username : "Some User",
				staffid : "991234"
			}
		});
	});
</script>
<!-- /TinyMCE -->
{/literal}

{literal}
<script language="JavaScript">
function check_form() {
	if ((document.edit_banner.name.value=='')) {
		alert("Заполните, пожалуйста, обязательные поля");
		return false;
	}
	else {
		return true;
	}
}
</script>
{/literal}

{if $error_message}<center><font color=red>{$error_message}</font></center><br>{/if}

<form action="" name=edit_banner method=POST enctype="multipart/form-data" onSubmit="return check_form();">

{if $mode=="edit"}
<input type=hidden name=id value={$banner.id}>
<input type=hidden name=old_ext value={$banner.image}>
{/if}

<table width=100% class="content_table">
	<tr>
		<th>{if $mode=='edit'}Редактируем баннер{else}Добавить баннер{/if}</th>
	</tr>
</table>

<table width=100% class="content_table">
	<tr>
		<td width=20% class=td1_left>
			<font color=red>*</font> Название:
		</td>
		<td class=td1_right>
			<input type=text name=name style="width:100%" value="{$banner.name}" class=field>
		</td>
	</tr>
	<tr>
		<td width=20% valign=top class=td1_left><font color=red>*</font> Группа:</td><td class=td1_right>
			<select name=group style="width:50%;" class=field>
			{foreach from=$groups_list item=entry}
				<option value="{$entry.id}" {if $banner.group==$entry.id}selected=true{/if}>{$entry.name}</option>
			{/foreach}
			</select>
		</td>
	</tr>
	<tr>
		<td width=20% valign=top class=td1_left>&nbsp;
			
		</td>
		<td class=td1_right>&nbsp;
			
		</td>
	</tr>
	<tr>
		<td width=20% valign=top class=td1_left><font color=red>*</font> Тип:</td><td class=td1_right>
			<select name=type style="width:50%;" class=field>
				<option value="0" {if $banner.type=='0'}selected=true{/if}>Картинка</option>
				<option value="1" {if $banner.type=='1'}selected=true{/if}>Flash анимация</option>
				<option value="2" {if $banner.type=='2'}selected=true{/if}>Код</option>
			</select>
		</td>
	</tr>

	<tr>
		<td width=20% valign=top class=td1_left>
			Баннер:
		</td>
		<td class=td1_right>
			
			<div id="code" style="display:{if $banner.type==2}block{else}none{/if};"><textarea name="code" style="width:100%; height:350px;">{$banner.code}</textarea></div>
		
			<div id="imagefile" style="display:{if $banner.type!="2"}block{else}none{/if};">
				{if $banner.image!=''}
				
				{if $banner.type=='0'}
				<img src={$base_url}/uploaded_files/banners/{$banner.id}.{$banner.image}>
				{else}
				
				<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="{$width}" height="{$height}">
				<param name="movie" value="{$base_url}/uploaded_files/banners/{$banner.id}.{$banner.image}">
				<param name="quality" value="high">
				<param name="wmode" value="transparent">
				<embed src="{$base_url}/uploaded_files/banners/{$banner.id}.{$banner.image}" wmode="transparent" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="{$width}" height="{$height}"></embed>
				</object>
				
				{/if}
				
				<br>
				<input type=checkbox name=delete_image> Удалить баннер
				<br><br>
				{/if}<input type=file name=image style="width:50%" class=field>
			</div>
		</td>
	</tr>
	
	<tr id="url" style="display:{if $banner.type==2}none{/if};">
		<td width=20% valign=top class=td1_left>
			<font color=red>*</font> URL страницы:
		</td>
		<td class=td1_right>
			<input type=text name=url style="width:100%" value="{$banner.target_url}" class=field>
		</td>
	</tr>
	
	<tr>
		<td width=20% valign=top class=td1_left>&nbsp;
			
		</td>
		<td class=td1_right>&nbsp;
			
		</td>
	</tr>
	
	<tr>
		<td width=20% valign=top class=td1_left>
			&nbsp;&nbsp;Показывать, раз:
		</td>
		<td class=td1_right>
			<input type=text name=showings style="width:50%" value="{if !$banner}10000{else}{$banner.showings}{/if}" class=field>{if $mode=="edit"} показано раз: {$banner.shown}{/if}
		</td>
	</tr>
	
	<tr>
		<td width=20% valign=top class=td1_left>
			&nbsp;&nbsp;Время показа:
		</td>
		<td class=td1_right>

			<table>
				<tr><td>C</td><td><input type="text" name="date_start" value="{$curdate|date_format:'%d-%m-%Y'}">{*html_select_date prefix='start_' start_year='2011' end_year='2021' time=$curdate*}</td></tr>
				<tr><td colspan="2" height="10"></td></tr>
				<tr><td>По</td><td><input type="text" name="date_end" value="{$curdate2|date_format:'%d-%m-%Y'}">{*html_select_date prefix='end_' start_year='2011' end_year='2021' time=$curdate2*}</td></tr>
			</table>

		</td>
	</tr>
	
	<tr>
		<td width=20% valign=top class=td1_left>&nbsp;</td>
		<td class=td1_right>&nbsp;</td>
	</tr>
	
	{*if $mode=="edit"}
	<tr>
		<td width=20% valign=top class=td1_left>&nbsp;&nbsp;Кликов:</td><td class=td1_right>{$banner.clicks}</td>
	</tr>
	{/if*}
	
	<tr>
		<td width=20% valign=top class=td1_left>&nbsp;&nbsp;Статус:</td><td class=td1_right>
			<select name=status style="width:50%;" class=field>
				<option value="1">Активный</option>
				<option value="0" {if $banner.status=='0'}selected=true{/if}>Ждёт</option>
			</select>
		</td>
	</tr>
	<tr>
		<td width=15% class=td1_left valign=top>Где показывать:</td>
		<td class=td1_right>
		<div style="height: 600px; width: 600px; overflow: auto;">
			<input type="checkbox" name="checked_all_items" value="1" id="checked_all_items">
			<label for="checked_all_items">Все</label>
		
			{assign var=urlslist value=$cat_checkboxes}
			{assign var=fullurl value="/"}
			{include file="../../modules/banners/admin/templates/banners.a_edit_banner_list.html"}
		</div>
		</td>
	</tr>
</table>
<br>
<center><input type=submit {if $mode=='edit'}name=submit_edit_banner value="Сохранить изменения"{else}name=submit_add_banner value="Добавить баннер"{/if}></center>

</form>

{literal}
<SCRIPT language=JavaScript>
<!--

$(function() {
	$( "input[name='date_start']" ).datepicker({ dateFormat: "dd-mm-yy"});
	$( "input[name='date_end']" ).datepicker({ dateFormat: "dd-mm-yy"});
});

$("#checked_all_items").click(function(){
	if ( $(this).attr("checked") )
		{
			$("input.checkbox_tree").attr("checked", "true");
		}
	else
		{
			$("input.checkbox_tree").removeAttr("checked");
		}
});

$("select[name='type']").change(function(){
	if ($(this).val() == 2)
	{
		
		$("#imagefile,#url").hide();
		$("#code").show();
	}
	else
	{
		$("#code").hide();
		$("#imagefile,#url").show();
	}
});

-->
</SCRIPT>
{/literal}